# vi: fdm=marker

# CONFIG {{{1
################################################################################

config:

  allow.huge.downloads:
    type: logical
    description: Download of huge files like whole database data is allowed.
    default: TRUE

  cache.all.requests:
    type: logical
    description: All requests are cached. If disabled, only requests of entries by accession number are cached.
    default: TRUE

  cache.directory:
    type: character
    description: The directory in which cache files are stored.

  cache.read.only:
    type: logical
    description: If set to TRUE, then the cache system becomes not writable. This is mainly used for test purposes.
    default: FALSE

  cache.subfolders:
    type: logical
    description: Use subfolders shortterm and longterm in cache system, in order to divide the downloaded files. If a whole database is downloaded, the file(s) will be put in the longterm subfolders.
    default: TRUE

  cache.system:
    type: logical
    description: Cache system is ON.
    default: TRUE

  dwnld.chunk.size:
    type: integer
    description: The number of entries to download before saving to cache. By default, saving to cache is only down once all requested entries have been downloaded.

  compute.fields:
    type: logical
    description: If the field of an entry is accessed but has no value, then biodb will try to compute one. This is done by following rules that tell biodb in which database to look for this field's value.
    default: TRUE

  factory.cache:
    type: logical
    description: Factory cache system is ON. The factory cache system stores entry instances already created. When the factory cache is enabled and an entry already created is requested, the factory returns that same instance. This is possible, because biodb uses the RefClass OOP system, which uses references instead of object copy. Thus, if you modify an entry and ask the factory for the same entry, it will be the same exact object that will be given to you and it will include your modifications. On the contrary, if the factory cache is OFF, a new entry instance will be returned to you each time. The factory cache enables to speed up entry retrieval when the same entries are requested several times, avoiding the parsing process.
    default: FALSE
    deprecated: The cache is now always enabled. Thus all entries returned are referenced inside the cache and will be returned when needed.

  force.locale:
    type: logical
    description: Forcing current locale is allowed.
    default: TRUE

  longterm.cache.subfolder:
    type: character
    description: The name of the long term cache subfolder.
    default: longterm
    deprecated: We do not use anymore a longterm subfolder in cache directory. Cache files are now stored under a different folder for each database.

  msg.caution.lvl:
    type: integer
    description: The desired level of caution messages. Set to 0 to turn messages off.
    default: 1

  msg.debug.lvl:
    type: integer
    description: The desired level of debug messages. Debug messages are turned off by default.
    default: 0

  msg.info.lvl:
    type: integer
    description: The desired level of information messages. Set to 0 to turn messages off.
    default: 1

  multival.field.sep:
    type: character
    description: The character used as separator when concatenating multiple values of a field.
    default: ';'

  intra.field.name.sep:
    type: character
    description: The character to use for separating words inside a field name. When defining or accessing a field, all non alphanumeric characters will be replaced by this character.
    default: '.'

  entries.sep:
    type: character
    description: The character used as separator when concatenating values from different entries.
    default: '|'

  offline:
    type: logical
    description: If set to TRUE, all network accesses are blocked. This is mainly used for test purposes.
    default: FALSE

  proton.mass:
    type: numeric
    description: The mass of a proton, in u or Da.
    default: 1.0072765

  shortterm.cache.subfolder:
    type: character
    description: The name of the short term cache subfolder.
    default: shortterm
    deprecated: We do not use anymore a shortterm subfolder in cache directory. Cache files are now stored under a different folder for each database.

  svn.binary.path:
    type: character
    description: The path to the SubVersion binary (svn).

  test.functions:
    type: character
    description: A comma separated list of test functions to run during tests. Only those functions will be run.

  useragent:
    type: character
    description: The user agent description string. This string is compulsory when connection to remote databases.

# DATABASES {{{1
################################################################################

databases:

# ChEBI {{{2
################################################################################

  chebi:
    entry.content.encoding: UTF-8
    entry.content.type: xml
    name: ChEBI
    parsing.expr:
      accession: substring-after(//chebi:return/chebi:chebiId,'CHEBI:')
      charge: //chebi:charge
      formula:
      - //chebi:Formulae/chebi:source[text()='ChEBI']/../chebi:data
      - (//chebi:Formulae/chebi:data)[1]
      inchi: //chebi:return/chebi:inchi
      inchikey: //chebi:return/chebi:inchiKey
      kegg.compound.id: //chebi:DatabaseLinks/chebi:type[text()='KEGG COMPOUND accession']/../chebi:data
      mass: //chebi:mass
      monoisotopic.mass: //chebi:monoisotopicMass
      name:
      - //chebi:chebiAsciiName
      - //chebi:Synonyms/chebi:data
      smiles: //chebi:return/chebi:smiles
    scheduler.n: 3
    searchable.fields:
        - name
        - monoisotopic.mass
        - molecular.mass
    urls:
      base.url: https://www.ebi.ac.uk/chebi/
      ws.url: https://www.ebi.ac.uk/webservices/chebi/2.0/
    xml.ns:
      chebi: https://www.ebi.ac.uk/webservices/chebi
      xsd: http://www.w3.org/2001/XMLSchema

# Mass CSV File {{{2
################################################################################
  mass.csv.file:
    entry.content.type: tsv
    name: Mass CSV File

# Mass SQLite {{{2
################################################################################
  mass.sqlite:
    entry.content.type: list
    name: Mass SQLite

# FIELDS {{{1
################################################################################

fields:

# General fields {{{2
################################################################################

  accession:
    description: The accession number of the entry.

  description:
    alias: protdesc
    description: The decription of the entry.

  name:
    alias:
    - fullnames
    - synonyms
    card: many
    case.insensitive: true
    description: The name of the entry.
    forbids.duplicates: true
    type: name

# Database IDs {{{2
################################################################################

  cas.id:
    alias: casid
    card: many
    case.insensitive: true
    description: CAS ID
    forbids.duplicates: true
    type: id

  chebi.id:
    description: ChEBI ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  chemspider.id:
    description: ChemSpider ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  hmdb.metabolites.id:
    description: HMDB Metabolites ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  kegg.compound.id:
    description: KEGG Compound ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  kegg.genes.id:
    description: KEGG Genes ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  mass.csv.file.id:
    description: Mass CSV File ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  mass.sqlite.id:
    description: Mass SQLite ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  ncbi.gene.id:
    description: NCBI Gene ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  ncbi.pubchem.comp.id:
    description: PubChem Compound ID
    case.insensitive: true
    forbids.duplicates: true
    type: id
    card: many

  compound.id:
    alias: compoundid
    card: many
    case.insensitive: true
    description: The compound ID.
    forbids.duplicates: true
    type: id

# Masses {{{2
################################################################################

  average.mass:
    class: double
    description: Average mass, or average molecular weight, or relative molecular mass, or molar mass is defined as the mass of a sample of a compound divided by the amount of substance in that sample. It takes into account the presence of isotopes inside the sample. See https://en.wikipedia.org/wiki/Molar_mass.
    type: mass

  molecular.mass:
    alias:
    - mass
    - molecular.weight
    class: double
    computable.from:
      - database: chebi
    description: Molecular mass (also called molecular weight), in u (unified atomic mass units) or Da (Dalton). It is computed from the atomic masses of each nuclide present in the molecule, taking into account the various possible isotops of each atom. See https://en.wikipedia.org/wiki/Molecular_mass.
    type: mass

  monoisotopic.mass:
    alias: exact.mass
    class: double
    description: Monoisotopic mass, in u (unified atomic mass units) or Da (Dalton). It is computed using the mass of the primary isotope of the elements including the mass defect (mass difference between neutron and proton, and nuclear binding energy). Used with high resolution mass spectrometers. See https://en.wikipedia.org/wiki/Monoisotopic_mass.
    type: mass

  nominal.mass:
    class: integer
    description: Nominal mass, in u (unified atomic mass units) or Da (Dalton). It is computed using the mass number of the most abundant isotope of each atom. Typically used with low resolution mass spectrometers. See https://en.wikipedia.org/wiki/Monoisotopic_mass.
    type: mass

# Peak fields {{{2
################################################################################

  peak.attr:
    description: Peak attribution.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.comp:
    description: Peak comp.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.error.ppm:
    class: double
    description: Peak error in PPM.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.formula:
    description: Peak formula.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.intensity:
    class: double
    description: Peak intensity.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.mass:
    class: double
    description: Peak mass.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.mztheo:
    class: double
    description: Peak theoretical M/Z.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.mzexp:
    class: double
    description: Peak experimental M/Z.
    type: peak
    dataFrameGroup: peaks
    card: many

  peak.mz:
    class: double
    description: Peak M/Z.
    type: peak
    dataFrameGroup: peaks
    card: many
    computable.from:
      - database: self
        fields:
          - peak.mzexp
          - peak.mztheo

  peak.relative.intensity:
    class: double
    description: Peak relative intensity, in percentage (from 0 to 100).
    type: peak
    dataFrameGroup: peaks
    card: many

  peaks:
    class: data.frame
    description: Peaks table.
    virtual: true
    virtual.group.by.type: peak

# Proteins and genes {{{2
################################################################################

  aa.seq.location:
    alias:
    - seq.location
    - location
    description: Location of the amino acids sequence.
  nt.seq:
    description: Nucleotids sequence.
  nt.seq.length:
    class: integer
    description: Length of the nucleotids sequence.
  organism:
    description: The biological organism to which this entry belongs.
  pathway.class:
    card: many
    description: Pathway class.

# Other fields {{{2
################################################################################

  catalytic.activity:
    card: many
    description: Catalytic activity.
  charge:
    class: integer
    description: Charge.
  chrom.col.constructor:
    description: Chromatographic column constructor.
  chrom.col.diameter:
    class: double
    description: Chromatographic column diameter.
  chrom.col.id:
    description: Chromatographic column ID.
  chrom.col.length:
    class: double
    description: Chromatographic column length.
  chrom.col.method.protocol:
    description: Chromatographic method protocol.
  chrom.col.name:
    alias:
    - chrom.col
    - chromcol
    description: Chromatographic column name.
  chrom.flow.gradient:
    description: Chromatographic column flow gradient.
  chrom.flow.rate:
    description: Chromatographic column flow rate.
  chrom.rt:
    alias:
    - chromcolrt
    - chrom.col.rt
    class: double
    description: Chromatographic column retention time.
  chrom.rt.max:
    alias: chrom.col.rt.max
    class: double
    description: Chromatographic column retention time maximum.
  chrom.rt.min:
    alias: chrom.col.rt.min
    class: double
    description: Chromatographic column retention time minimum.
  chrom.rt.unit:
    alias: chrom.col.rt.unit
    allowed.values:
    - min
    - s
    description: Chromatographic column retention time unit.
    lower.case: true
  chrom.solvent:
    card: many
    description: Chromatographic column solvent.
  cofactor:
    card: many
    description: Cofactor.
  comp.iupac.name.allowed:
    description: IUPAC allowed name
    type: name
  comp.iupac.name.cas:
    description: IUPAC CAS name
    type: name
  comp.iupac.name.pref:
    description: IUPAC preferred name
    type: name
  comp.iupac.name.syst:
    description: IUPAC systematic name
    type: name
  comp.iupac.name.trad:
    description: IUPAC traditional name
    type: name
  comp.super.class:
    alias:
    - superclass
    - super.class
    description: Compound super class.
  equation:
    description: Chemical equation
  formula:
    description: Empirical molecular formula.
  inchi:
    computable.from:
      - database: chebi
    description: International Chemical Identifier (InChI).
  inchikey:
    computable.from:
      - database: chebi
    description: Hash key of the International Chemical Identifier (InChIKey).
  logp:
    class: double
    description: logP
  ms.level:
    class: integer
    description: Mass spectrum level.
  ms.mode:
    alias: msmode
    allowed.values:
      neg:
      - '-'
      - negative
      pos:
      - +
      - positive
    description: Mass spectrometry mode.
    lower.case: true
  msdev:
    description: Mass spectrometer device.
  msdevtype:
    description: Mass spectrometer device type.
  msprecannot:
    description: MS precursor annotation.
  msprecmz:
    card: many
    class: double
    description: MS precursor M/Z value.
  mstype:
    description: Mass spectrometry type.
  nb.compounds:
    alias: nbcompounds
    class: integer
    description: Number of associated compounds.
  nb.peaks:
    alias: nbpeaks
    class: integer
    description: Number of MS peaks.
  products:
    card: many
    description: Products of an enzymatic chemical reaction.
  smiles:
    description: SMILES.
  smiles.canonical:
    description: SMILES canonical.
  smiles.isomeric:
    description: SMILES isomeric.
  substrates:
    card: many
    description: Substrates of an enzymatic chemical reaction.
