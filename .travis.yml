notifications:
 email:
  recipients:
   - pk.roger@icloud.com
                           
before_install:
 - sudo sed -i -e '$adeb http://cran.univ-paris1.fr/bin/linux/ubuntu trusty/' /etc/apt/sources.list
 - sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E084DAB9
 - sudo apt-get update
   
install:
 - sudo apt-get install -y r-base
 - sudo R -e "install.packages(c('getopt', 'stringr', 'plyr', 'XML', 'jsonlite', 'bitops', 'stats', 'R.utils', 'digest', 'testthat', 'devtools'), lib='/usr/lib/R/library', dependencies = TRUE, repos='http://cran.univ-paris1.fr/')"

branches:
  only:
    - master
    - develop
    - /^release\/.*$/
 
script:
 - make test # Run offline tests for all databases
 - [ -z "$(git branch | egrep '^\* (release|master)')" ] || MODES=online make test # Run online test only for master and release branches
 - make check # Check R package
 - sudo make install # Install R package
 - make ex # Run examples
